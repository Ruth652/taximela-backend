FROM eclipse-temurin:17-jre-jammy

# Install curl for health checks
RUN apt-get update && apt-get install -y curl && rm -rf /var/lib/apt/lists/*

# Copy OTP files
COPY otp/ /app/otp/
WORKDIR /app/otp

# Expose port
EXPOSE 8080

# Health check
HEALTHCHECK --interval=30s --timeout=10s --start-period=60s \
  CMD curl -f http://localhost:8080/otp/routers/default || exit 1

# Start OTP
CMD ["java", "-Xmx1G", "-jar", "otp-2.3.0-shaded.jar", "--load", "--serve", "graphs/default"]